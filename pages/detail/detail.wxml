<!--pages/detail/detail.wxml-->
<wxs src='/wxs/time.wxs' module="tools"/>
<!-- <wxs src='/wxs/reply.wxs' module="tools"/> -->
<view class='scbg' scroll-y='true' >
<block wx:for="{{list}}" wx:for-item="itemName" wx:for-index="id" wx:key='id'>
  <view class='box'>
    <view class='firstblock'>
      <view class='person'>
        <view class='name'>
          <text class='showname'># {{itemName.id}}</text>
          <text class="tag" style="background-color: #ff9900" wx:if= "{{itemName.tag ==1}}">情感</text>
          <text class="tag" style="background-color: #9999ff" wx:if= "{{itemName.tag ==2}}">交友</text>
          <text class="tag" style="background-color: #00cc44" wx:if= "{{itemName.tag ==3}}">寻物</text>
          <text class="tag" style="background-color: #ffaf99" wx:if= "{{itemName.tag ==4}}">吐槽</text>
        </view>
        <view class='tel'>
          <text class='showtime'>{{tools.timeFormat(itemName.time)}}</text>
        </view>
      </view>
    </view>
    <view class='secondblock'>
      <text class='content'>{{itemName.content}}</text>
    </view>
    <view class='thirdblock'>
      <image class='more' src="/images/more.png" data-openid='{{itemName.openid}}' bindtap="onTapMore" data-_id='{{itemName._id}}'></image>
      <image class='like' bindtap="like"  wx:if="{{!itemName.islike}}" src='/images/like.png' data-_id='{{itemName._id}}'></image>
      <image class='like' bindtap="like"  wx:elif="{{itemName.islike}}" src='/images/likeplus.png' data-_id='{{itemName._id}}'></image>
      <text class='num_like' wx:if="{{itemName.likes != 0 && itemName.likes <= 99}}">{{itemName.likes}}</text>
                                        <!-- 用空格占位 -->
      <text class='num_like' wx:if="{{itemName.likes == 0}}">  </text>
      <text class='num_like' wx:if="{{itemName.likes > 99 && itemName.likes <= 999}}" style="width: 60rpx">{{itemName.likes}}</text>
      <text class='num_like' wx:if="{{itemName.likes > 999}}" style="width: 70rpx">999+</text>
      <image id="replycontent" class='like' bindtap="reply0" data-message_id="{{itemName._id}}" src="/images/comment.png"></image>
      <text class='num_comment' wx:if="{{itemName.comments != 0 && itemName.comments <= 99}}">{{itemName.comments}}</text>
      <text class='num_comment' wx:if="{{itemName.comments > 99 && itemName.comments <= 999}}" style="width: 60rpx">{{itemName.comments}}</text>
      <text class='num_comment' wx:elif="{{itemName.comments == 0}}">  </text>
      <text class='num_comment' wx:elif="{{itemName.comments > 999}}" style="width: 70rpx">999+</text>
    </view>
  </view>
</block>
<view class="commentbox">
  <block wx:for="{{comment}}" wx:for-item="itemName" wx:for-index="id">
  <view>
    <view class="replyview" wx:if="{{itemName.reply_to}}">
      <!-- <text class="replytxt" wx:if="{{itemName.reply_to}}"></text> -->
      <text class="replytxt"> 回复: {{tools.contentFormat(itemName.reply_to)}}</text>
    </view>
    <view class='commentfirstblock' >
      <view class='commentperson'>
        <view class='commentname'>
          <text class='commentnametxt'>{{itemName.username}}</text>
        </view>
        <view class='commenttel'>
          <text class='commenttime'>{{tools.timeFormat(itemName.time)}}</text>
        </view>
      </view>
      <view class='thirdblock'>
        
        <image class='like' bindtap="commentlike"  wx:if="{{!itemName.islike}}" src='/images/like.png' data-_id="{{itemName._id}}"></image>
        <image class='like' bindtap="commentlike"  wx:elif="{{itemName.islike}}" src='/images/likeplus.png' data-_id="{{itemName._id}}"></image>
        <text class='num_like'>{{itemName.likes}}</text>
      </view>
    </view>
    <view class='commentcontentblock' >
      <text class='commentcontent'>{{itemName.content}}</text>
    </view>
    <view class='bottom'>
      <image class='commentmore' src="/images/more.png" data-openid='{{itemName.openid}}' bindtap="onTapMore" data-_id='{{itemName._id}}'></image>
      <text id="replycontent" class='replycontent' bindtap="reply1"data-message_id="{{itemName.message_id}}" data-reply_to="{{itemName.content}}">回复</text>
    </view>
  </view>

</block>
<view wx:if="{{!comment.length}}" class="nocommentview">
    <image class="nocommentpic" src="/images/nocomment.png"></image>
    <text class="nocommenttxt">暂无回复，等你来喔~</text>
</view>
</view>
</view>

<view catchtap="hideKeyboard" class="back-page" hidden="{{!releaseFocus}}">
    <view class="release">
        <textarea autoFocus="true" autoHeight="true" bindblur="hideKeyboard" bindinput="setValue" catchtap="catchBubble" class="text" cursorSpacing="20" fixed="true" focus="true" placeholder="{{placeholder?placeholder:'写评论'}}" placeholderClass="input_null" showConfirmBar="" value="{{commentValue}}" maxlength="600"></textarea>
        <view catchtap="reply_by_type" class="submit">发送</view>
    </view>
</view>

